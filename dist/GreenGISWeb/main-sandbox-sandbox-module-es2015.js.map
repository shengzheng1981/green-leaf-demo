{"version":3,"sources":["./src/app/main/sandbox/sandbox.module.ts","./src/app/main/sandbox/sandbox.component.ts","./src/app/main/sandbox/sandbox.component.scss","./src/app/main/sandbox/sandbox.component.html"],"names":[],"mappings":"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","file":"main-sandbox-sandbox-module-es2015.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {RouterModule, Routes} from \"@angular/router\";\nimport {CoreModule} from \"../../core/core.module\";\nimport {SharedModule as MainSharedModule} from \"../shared/shared.module\";\nimport {SandboxComponent} from \"./sandbox.component\";\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: SandboxComponent\n    }\n];\n\n@NgModule({\n    imports: [\n        CoreModule.forChild(),\n        MainSharedModule,\n        RouterModule.forChild(routes)\n    ],\n    declarations: [\n        SandboxComponent\n    ]\n})\nexport class SandboxModule {\n}\n","import {Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {ConfigService} from \"../../core/config.service\";\nimport {Router} from \"@angular/router\";\nimport {\n    Feature,\n    FeatureClass,\n    FeatureLayer, Field,\n    GeometryType, Graphic,\n    Label, NullCollision,\n    Point, SimpleMarkerSymbol,\n    SimplePointSymbol,\n    SimpleTextSymbol\n} from \"green-gis\";\nimport {HttpClient} from \"@angular/common/http\";\ndeclare var CodeMirror;\n@Component({\n    selector: 'app-sandbox',\n    templateUrl: './sandbox.component.html',\n    styleUrls: ['./sandbox.component.scss']\n})\nexport class SandboxComponent implements OnInit {\n    @ViewChild('sandbox', {static:true}) sandbox: ElementRef;\n    @ViewChild('textarea', {static:true}) textarea: ElementRef;\n    editor: any;\n    source: string;\n\n    scripts: any = [];\n\n    constructor(private router: Router, public configService: ConfigService, private http: HttpClient) {\n    }\n\n    ngOnInit(): void {\n        this.editor = CodeMirror.fromTextArea(this.textarea.nativeElement, {\n            lineNumbers: true,\n            styleActiveLine: true,\n            mode: \"htmlmixed\"\n        });\n        this.http.get(\"assets/json/scripts.json\").subscribe( data => {\n            this.scripts = data;\n            this.source = this.scripts[0].items[0].script;\n            this.editor.setValue(this.source);\n            this.run();\n        });\n        this.source = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <script type=\"text/javascript\" src=\"https://unpkg.com/green-leaf@0.0.7/green-leaf.js\"></script>\n  <link rel=\"stylesheet\" href=\"https://unpkg.com/green-leaf@0.0.7/leaflet.css\">\n</head>\n<body style=\"margin: 0px; overflow: hidden;\">\n  <div id=\"foo\" style=\"width: 100%; height: 100%; overflow: hidden;\"></div>\n  <script>\n    const map = new Green.Map(\"foo\");\n    //加载OSM切片\n    const tile = new Green.Tile('http://{s}.tile.osm.org/{z}/{x}/{y}.png');\n    tile.addTo(map);\n    \n    map.setView(new Green.LatLng(39.909186, 116.397411), 12);\n    //设置渲染符号\n    const symbol = new Green.SimplePointSymbol();\n    const point = new Green.Point(new Green.LatLng(39.909186, 116.397411));\n    const graphic = new Green.Graphic(point, symbol);\n    //添加单个图形\n    map.addGraphic(graphic);\n  </script>\n</body>\n</html>`;\n    }\n\n    change(script) {\n        this.source = script;\n        this.editor.setValue(this.source);\n        this.run();\n    }\n\n    run() {\n        this.source = this.editor.getValue();\n        setTimeout(() => {\n          const iframe = document.createElement('iframe');\n          iframe.style.height = \"100%\";\n          iframe.style.width = \"100%\";\n          iframe.style[\"border\"] = \"1px solid #ededed\";\n          iframe.style[\"box-shadow\"] = \"3px 3px 8px rgba(0,0,0,0.2)\";\n          const parent = this.sandbox.nativeElement;\n          while (parent.firstChild) {\n            parent.removeChild(parent.firstChild);\n          }\n          parent.appendChild(iframe);\n\n          const frameDocument = iframe.contentDocument || iframe.contentWindow.document;\n          frameDocument.open();\n          frameDocument.write(this.source);\n          frameDocument.close();\n            // this.sandbox.nativeElement.contentWindow.document.body.innerHTML = \"\";\n            // this.sandbox.nativeElement.contentDocument.open();\n            // this.sandbox.nativeElement.contentDocument.write(this.source);\n            // this.sandbox.nativeElement.contentDocument.close();\n        });\n    }\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzYW5kYm94LmNvbXBvbmVudC5zY3NzIn0= */\";","export default \"<div class=\\\"system-content\\\" style=\\\"grid-template-columns: 1fr\\\">\\n    <div class=\\\"system-body\\\" style=\\\"display: grid; grid-template-columns: 1fr 2fr 3fr;\\\">\\n        <ul nz-menu nzMode=\\\"inline\\\" style=\\\"overflow-y: auto; overflow-x: hidden;\\\">\\n            <li nz-submenu *ngFor=\\\"let group of scripts\\\" [nzTitle]=\\\"group.title\\\" [nzOpen]=\\\"group.open\\\">\\n                <ul>\\n                    <li nz-menu-item *ngFor=\\\"let item of group.items\\\" [nzSelected]=\\\"item.selected\\\" (click)=\\\"change(item.script)\\\">{{item.title}}</li>\\n                </ul>\\n            </li>\\n        </ul>\\n        <div class=\\\"panel panel-grid\\\" style=\\\"height: 100%; width: 100%; padding: 10px;\\\">\\n            <div class=\\\"panel-heading\\\" style=\\\"display: grid; grid-template-columns: 1fr auto\\\">\\n                <div class=\\\"panel-title\\\">源码</div>\\n                <div class=\\\"panel-action\\\">\\n                    <button class=\\\"btn btn-xs btn-primary\\\" (click)=\\\"run()\\\">运行</button>\\n                </div>\\n            </div>\\n            <div class=\\\"panel-body\\\" style=\\\"overflow-y: hidden;\\\">\\n                <textarea #textarea style=\\\"height: 100%; width: 100%;\\\"></textarea>\\n            </div>\\n        </div>\\n        <div #sandbox class=\\\"panel\\\" style=\\\"height: 100%; width: 100%; padding: 10px;\\\">\\n            <!-- <iframe sandbox=\\\"allow-same-origin allow-scripts\\\" style=\\\"height: 100%; width: 100%; border: 1px solid #ededed;\\n            box-shadow: 3px 3px 8px rgba(0,0,0,0.2)\\\"></iframe> -->\\n        </div>\\n    </div>\\n</div>\\n\";"],"sourceRoot":"webpack:///"}